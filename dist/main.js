(()=>{"use strict";class e{constructor(e,t="",o,r,c){this.title=e,this.description=t,this.dueDate=o,this.priority=r,this.project=c}setTitle(e){this.title=e}setDescription(e){this.description=e}setDueDate(e){this.dueDate=e}setPriority(e){this.priority=e}}class t{constructor(e){this.title=e,this.myTodos=[]}addItem(e){this.myTodos.push(e)}setTitle(e){this.title=e}deleteItem(e){const t=this.myTodos.indexOf(e);this.myTodos.splice(t,1)}getLength(){return this.myTodos.length}}const o={curr:"",editItem:"",folder:""};function r(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function c(e){const t=document.querySelector(".edit-form-container"),c=document.querySelector("#content"),n=document.createElement("div");n.classList.add("todo");const l=document.createElement("p");l.innerHTML=`${e.title}`;const s=document.createElement("p");s.innerHTML=`${e.dueDate}`;const d=document.createElement("p");d.innerHTML=`${e.description}`,"high"===e.priority?n.classList.add("high"):"medium"===e.priority?n.classList.add("medium"):n.classList.add("low");const a=document.createElement("button");a.innerHTML="🗑️",a.setAttribute("class","todoBtn");const u=document.createElement("button");return u.setAttribute("class","todoBtn"),u.innerHTML="📝",n.appendChild(l),n.appendChild(s),n.appendChild(d),n.appendChild(a),n.appendChild(u),a.addEventListener("click",(()=>{e.project.deleteItem(e);const t=JSON.parse(localStorage.getItem("myProjects"));for(let o of t.projectList)for(let t of o.myTodos)t.title===e.title&&(o.myTodos.splice(o.myTodos.indexOf(t),1),console.log(t));localStorage.setItem("myProjects",JSON.stringify(t)),r(c);const o=i(e.project);c.appendChild(o)})),u.addEventListener("click",(()=>{t.classList.toggle("hidden"),o.editItem=e,console.log(o.editItem),document.querySelector("#editTitle").setAttribute("value",`${e.title}`),document.querySelector("#editDate").setAttribute("value",`${e.dueDate}`),document.querySelector("#editDescription").value=`${e.description}`;const r=document.getElementsByName("editPriority");for(let t of r)t.value===`${e.priority}`&&(t.checked=!0)})),n}function i(e){console.log(`current: ${o.curr}`);const t=document.createElement("div");t.setAttribute("id","projectDiv");const n=document.createElement("h2");if(n.innerHTML=`${e.title}`,t.appendChild(n),e.myTodos.length>0)for(let o of e.myTodos){const e=c(o);t.appendChild(e)}else{const e=document.createElement("p");e.innerHTML="No Tasks",t.appendChild(e)}if("Inbox"!==e.title){const e=document.createElement("button");e.classList.add("deleteProject"),e.innerHTML="Delete Project",t.appendChild(e),e.addEventListener("click",(()=>{const e=document.querySelector("#project-list"),t=JSON.parse(localStorage.getItem("myProjects"));o.folder.deleteProject(o.curr);for(let e of t.projectList)e.title===o.curr.title&&t.projectList.splice(t.projectList.indexOf(e),1);localStorage.setItem("myProjects",JSON.stringify(t)),r(content),o.curr=o.folder.getProject("Inbox");const c=i(o.curr);content.appendChild(c),r(e);for(let t of o.folder.projectList){const o=populateSidebar(t),r=document.createElement("li");e.appendChild(r),r.appendChild(o)}}));const c=document.createElement("button");c.classList.add("renameProject"),c.innerHTML="Rename Project",t.appendChild(c),c.addEventListener("click",(()=>{document.querySelector(".rename-container").classList.toggle("hidden")}))}return t}function n(e){const t=document.createElement("button");t.innerHTML=`${e.title}`,t.dataset.name=`${e.title}`,t.setAttribute("id",`${e.title}`),t.classList.add("proj-title");const c=document.querySelector("#content");return t.addEventListener("click",(()=>{r(c);const t=i(e);o.curr=e,c.appendChild(t)})),t}function l(e){return{title:e.title,description:e.description,dueDate:e.dueDate,priority:e.priority,project:e.project.title}}const s=document.querySelector("#content"),d=document.querySelector("#add"),a=document.querySelector("#add-project"),u=document.querySelector(".form-container"),m=document.querySelector(".project-form-container"),p=document.querySelector("#close-todo"),y=document.querySelector("#close-project"),f=document.querySelector("#close-rename"),h=document.querySelector("#rename-form"),g=document.querySelector("#project-form"),L=document.querySelector("#proj-title"),j=document.querySelector("#addTodo"),S=document.querySelector("#today"),T=document.querySelector("#upcoming"),v=document.querySelector("#close-edit"),E=document.querySelector("#editTodo"),q=document.querySelector("#hamburger"),C=new class{constructor(){this.projectList=[]}addProject(e){this.projectList.push(e)}filterToday(){let e=[],t=(new Date).toJSON().slice(0,10);for(let o of this.projectList)for(let r of o.myTodos)r.dueDate===t&&e.push(r);return e}filterUpcoming(){let e=[],t=(new Date).toJSON().slice(0,10);for(let o of this.projectList)for(let r of o.myTodos)r.dueDate!==t&&e.push(r);return e}deleteProject(e){const t=this.projectList.indexOf(e);this.projectList.splice(t,1)}getProject(e){for(let t of this.projectList)if(t.title===e)return t}};if(o.folder=C,localStorage.getItem("myProjects")){const r=JSON.parse(localStorage.getItem("myProjects"));for(let o of r.projectList){let r=new t(o.title);C.addProject(r);for(let t of o.myTodos){let o=new e(t.title,t.description,t.dueDate,t.priority,r);r.addItem(o)}const c=n(r),i=document.querySelector("#project-list"),l=document.createElement("li");i.appendChild(l),l.appendChild(c)}const c=i(C.getProject("Inbox"));s.appendChild(c),o.curr=C.getProject("Inbox")}else{const e=new t("Inbox");C.addProject(e),localStorage.setItem("myProjects",JSON.stringify(C));const r=i(e);s.appendChild(r),o.curr=e;const c=n(e),l=document.querySelector("#project-list"),d=document.createElement("li");l.appendChild(d),d.appendChild(c)}j.addEventListener("submit",(t=>{t.preventDefault();const c=document.querySelector("#title"),n=document.querySelector("#date"),d=document.querySelector("#description");let a,m=document.getElementsByName("priority"),p=c.value,y=n.value,f=d.value;for(let e of m)e.checked&&(a=e.value);let h=new e(p,f,y,a,o.curr);o.curr.addItem(h);const g=JSON.parse(localStorage.getItem("myProjects"));for(let e of g.projectList)e.title===o.curr.title&&e.myTodos.push(l(h));localStorage.setItem("myProjects",JSON.stringify(g)),c.value="",n.value="",d.value="",m.value="low",u.classList.toggle("hidden"),r(s);const L=i(o.curr);s.appendChild(L)})),S.addEventListener("click",(()=>{const e=document.createElement("h2");e.innerHTML="Today's Tasks";const t=C.filterToday();if(r(s),s.appendChild(e),0===t.length){const e=document.createElement("p");e.innerHTML="No tasks for today",s.appendChild(e)}else for(let e of t){let t=c(e);s.appendChild(t)}})),T.addEventListener("click",(()=>{const e=document.createElement("h2");e.innerHTML="Upcoming Tasks";const t=C.filterUpcoming();if(r(s),s.appendChild(e),0===t.length){const e=document.createElement("p");e.innerHTML="No upcoming tasks",s.appendChild(e)}else for(let e of t){let t=c(e);s.appendChild(t)}})),d.addEventListener("click",(()=>{u.classList.toggle("hidden")})),p.addEventListener("click",(()=>{u.classList.toggle("hidden")})),a.addEventListener("click",(()=>{m.classList.toggle("hidden")})),y.addEventListener("click",(()=>{m.classList.toggle("hidden")})),g.addEventListener("submit",(e=>{e.preventDefault(),m.classList.toggle("hidden");let o=L.value,r=new t(o);C.addProject(r);const c=JSON.parse(localStorage.getItem("myProjects"));c.projectList.push(r),localStorage.setItem("myProjects",JSON.stringify(c));const i=n(r),l=document.querySelector("#project-list"),s=document.createElement("li");l.appendChild(s),s.appendChild(i),L.value=""})),v.addEventListener("click",(()=>{document.querySelector(".edit-form-container").classList.toggle("hidden")})),E.addEventListener("submit",(e=>{e.preventDefault(),console.log(o.curr.title);const t=JSON.parse(localStorage.getItem("myProjects"));for(let e of t.projectList)for(let t of e.myTodos)t.title===o.editItem.title&&e.myTodos.splice(e.myTodos.indexOf(t),1);const c=document.querySelector(".edit-form-container"),n=document.querySelector("#editTitle").value,d=document.querySelector("#editDate").value,a=document.querySelector("#editDescription").value,u=document.getElementsByName("editPriority");let m;o.editItem.setTitle(n),o.editItem.setDescription(a),o.editItem.setDueDate(d);for(let e of u)e.checked&&(m=e.value);o.editItem.setPriority(m);for(let e of t.projectList)e.title===o.editItem.project.title&&e.myTodos.push(l(o.editItem));localStorage.setItem("myProjects",JSON.stringify(t)),c.classList.toggle("hidden"),r(s);const p=i(o.curr);s.appendChild(p)})),q.addEventListener("click",(()=>{const e=document.querySelector("#sidebar");e.style.display="block"===e.style.display?"none":"block"})),f.addEventListener("click",(()=>{document.querySelector(".rename-container").classList.toggle("hidden")})),h.addEventListener("submit",(e=>{e.preventDefault();const t=document.querySelector("#project-list"),c=document.querySelector(".rename-container"),d=document.querySelector("#rename-title").value,a=JSON.parse(localStorage.getItem("myProjects"));for(let e of a.projectList)e.title===o.curr.title&&a.projectList.splice(a.projectList.indexOf(e),1);for(let e of C.projectList)e.title===o.title&&C.projectList.splice(C.projectList.indexOf(e),1,o.curr.setTitle(d));console.log(C.projectList),o.curr.setTitle(d),r(t);for(let e of C.projectList){const o=n(e),r=document.createElement("li");t.appendChild(r),r.appendChild(o)}const u=o.curr;for(let e of u.myTodos)u.myTodos.splice(u.myTodos.indexOf(e),1,l(e));a.projectList.push(u),localStorage.setItem("myProjects",JSON.stringify(a)),r(s);const m=i(o.curr);s.appendChild(m),c.classList.toggle("hidden")}))})();